<!DOCTYPE html>
<html>
<head>
    <title>Java Streamlit (CLI)</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div id="app-container" class="max-w-4xl mx-auto p-6 bg-white shadow-xl rounded-xl">
        <div class="text-center text-gray-500">In attesa del server...</div>
    </div>
    <script>
        const container = document.getElementById('app-container');
        let sid = sessionStorage.getItem('sid');
        if (!sid) {
            sid = crypto.randomUUID();
            sessionStorage.setItem('sid', sid);
        }

        async function sendUpdate(id, val) {
            try {
                const r = await fetch('/ui?sessionId=' + sid, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ id: id, value: val })
                });
                if (r.ok) container.innerHTML = await r.text();
            } catch (e) { console.error(e); }
        }
        
        async function load() {
            try {
                const r = await fetch('/ui?sessionId=' + sid);
                if (r.ok) container.innerHTML = await r.text();
            } catch (e) { container.innerHTML = "Server non raggiungibile."; }
        }
        window.sendUpdate = sendUpdate;
        window.onload = load;
    </script>
</body>
</html>